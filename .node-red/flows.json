[{"id":"49459178.c9087","type":"tab","label":"heroku server","disabled":false,"info":""},{"id":"9bd5fb7f.13cf18","type":"template","z":"49459178.c9087","name":"","field":"payload","fieldType":"msg","format":"html","syntax":"mustache","template":"<!DOCTYPE html>\n<html lang=\"ja\">\n    <head>\n        <meta charset=\"utf-8\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <meta name=\"viewport\" content=\"width=device-width,initial-scale=1,viewport-fit=cover\">\n        <title>LINE LIFF Demo</title>\n    </head>\n    <body>\n        <div id=\"app\">\n            <img :src=pictureUrl alt=\"profile\" width=\"100px\"　align=\"left\"/>\n            <h2><% displayName %></h2>\n            <p><% userId %></p>\n            <p><% statusMessage %></p>\n            <button @click=logout></button>\n        </div>\n\n        <script src=\"https://cdn.jsdelivr.net/npm/vue/dist/vue.js\"></script>\n        <script src=\"https://static.line-scdn.net/liff/edge/versions/2.6.0/sdk.js\"></script>\n        <script>\n            'use strict';\n\n            const app = new Vue({\n                el: '#app',\n                data: function(){\n                    return{\n                        displayName: '',\n                        userId: '',\n                        statusMessage: '',\n                        pictureUrl: '',\n                    }\n                },\n                delimiters: [\"<%\",\"%>\"],\n                methods: {\n                    //get line user info \n                    getProfile: async function(){\n                        const accessToken = liff.getAccessToken();\n                        const profile = await liff.getProfile();\n                        this.displayName = profile.displayName; \n                        this.userId = profile.userId; //ID\n                        this.pictureUrl = profile.pictureUrl; \n                        this.statusMessage = profile.statusMessage; \n                    },\n                    //log out \n                    logout: async function(){\n                        if (liff.isLoggedIn()){\n                            alert('登出');\n                            liff.logout();\n                            window.location.reload();\n                        }\n                    },\n                },\n                \n                //LIFF init \n                mounted: async function(){\n                    await liff.init({\n                        liffId: \"1655113925-ZYDom4rm\"\n                    });  \n                    //LINE内のブラウザかどうか\n                    if(liff.isInClient()){\n                        alert('LINE内のブラウザ');\n                        this.getProfile(); //LINE内で開いた場合はログイン処理なし\n                    }else{\n                    //外部ブラウザかどうか\n                        if(liff.isLoggedIn()){\n                            alert('外部ブラウザ');\n                            this.getProfile();\n                        }else{\n                            liff.login();\n                        }\n                    }\n                }\n                \n            });\n        </script>\n    </body>\n</html>","output":"str","x":390,"y":200,"wires":[["e4f7ce1f.2d842"]]},{"id":"d9d308e5.2f1bb8","type":"http in","z":"49459178.c9087","name":"","url":"/line","method":"get","upload":false,"swaggerDoc":"","x":220,"y":200,"wires":[["9bd5fb7f.13cf18"]]},{"id":"e4f7ce1f.2d842","type":"http response","z":"49459178.c9087","name":"","statusCode":"","headers":{},"x":570,"y":200,"wires":[]},{"id":"74a353e0.03df3c","type":"inject","z":"49459178.c9087","name":"設定 liff_id","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"1655113925-ZYDom4rm","payloadType":"str","x":230,"y":100,"wires":[["78e48edf.58722"]]},{"id":"78e48edf.58722","type":"change","z":"49459178.c9087","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"liff_id","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":410,"y":100,"wires":[[]]}]