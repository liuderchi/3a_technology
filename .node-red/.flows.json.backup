[{"id":"b59bc4d3.917488","type":"tab","label":"heroku deploy","disabled":false,"info":""},{"id":"6a71d497.0c584c","type":"tab","label":"wake up timer","disabled":false,"info":""},{"id":"ac1b684.5895598","type":"tab","label":"UI","disabled":false,"info":""},{"id":"faa3bd83.e694f","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"c4e0aa35.416768","type":"ui_tab","name":"é¡¯ç¤ºåœ–è¡¨","icon":"dashboard","order":1,"disabled":false,"hidden":false},{"id":"e94029d3.110278","type":"ui_group","name":"Group 1","tab":"c4e0aa35.416768","order":1,"disp":false,"width":"10","collapse":false},{"id":"da9c5ba5.582488","type":"ui_spacer","name":"spacer","group":"e94029d3.110278","order":3,"width":3,"height":1},{"id":"ae996d64.15fb3","type":"ui_spacer","name":"spacer","group":"e94029d3.110278","order":5,"width":3,"height":1},{"id":"49eeb9d7.b013e8","type":"http in","z":"b59bc4d3.917488","name":"","url":"/line","method":"get","upload":false,"swaggerDoc":"","x":100,"y":180,"wires":[["ccb5bcbe.5d6bf","2ab1d1a9.9da91e"]]},{"id":"e184963c.01a588","type":"http response","z":"b59bc4d3.917488","name":"","statusCode":"","headers":{},"x":750,"y":180,"wires":[]},{"id":"80b9e0e4.c75be","type":"template","z":"b59bc4d3.917488","name":"Line é›»å­åç‰‡","field":"payload","fieldType":"msg","format":"html","syntax":"mustache","template":"<html>\n    <head>\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>{{title}}</title>\n    </head>\n   \n    <body>\n        <p id=\"displaynamefield\" align=\"center\"> </p>\n        <img id=\"displaypic\" class=\"center\"/> \n        <br>\n        <button class=\"button\" onclick=\"get_profile()\" >å¾—åˆ°å€‹äººè³‡è¨Š</button>\n        <button class=\"button\" onclick=\"sendTargetPicker()\" >åˆ†äº«æˆ‘çš„åç‰‡</button>\n        <button class=\"button\" onclick=\"log_out()\" >ç™»å‡º</button>\n        <button class=\"button\"  onclick=\"location.href='https://liff--demo.herokuapp.com/ui'\">åœ–è¡¨</button>\n      \n        <script src=\"https://static.line-scdn.net/liff/edge/versions/2.6.0/sdk.js\"></script>\n        <script>\n            var userId = \"\";\n            var image_src = \"https://i.imgur.com/BL8SojQ.jpg\";\n          \n            window.onload = function() {\n                initializeLiff(\"{{liff_id}}\"); \n                this.my_short_name = \"{{short_name}}\"; a\n                this.my_card = {{{my_card}}};\n                document.getElementById('displaypic').src = image_src;                        \n            };\n            \n            function initializeLiff(myLiffId) {\n                liff\n                    .init({\n                        liffId: myLiffId\n                    })\n                    .then(() => {\n                                           \n                    })\n                    .catch((err) => {\n                        document.getElementById('displaynamefield').textContent = \"LINE profileæ“·å–å¤±æ•—\";\n                    });\n            }\n            function get_profile(){\n                liff.getProfile().then(function(profile) {\n                    document.getElementById('displaynamefield').textContent = 'ä½ çš„åå­—: ' + profile.displayName;\n                    document.getElementById('displaypic').src = profile.pictureUrl;\n                    userId = profile.userId;\n                }).catch(function(error) {\n                    window.alert('Error getting profile: ' + error);\n                })\n            }\n            function log_out(){\n                if (liff.isLoggedIn()) {\n                    document.getElementById('displaynamefield').textContent = '';\n                    document.getElementById('displaypic').src = image_src; \n                    alert(\"ç™»å‡ºæˆåŠŸ\");               \n                }\n            }\n            function sendTargetPicker() {\n                   \n                    if (!liff.isLoggedIn()) {\n                        liff.login({ redirectUri: window.location.href });\n                    }\n                    var flex = {\n                        \"type\": \"flex\",\n                        \"altText\": my_short_name,\n                        \"contents\": my_card,          \n                    };\n                    if (liff.isApiAvailable(\"shareTargetPicker\")) {\n                        liff\n                        .shareTargetPicker([flex])\n                        .then(function (res) {\n                            if (res) {\n                            alert(\"é›»å­åç‰‡å‚³é€æˆåŠŸ\");\n                            liff.closeWindow();\n                            } else {\n                            const [majorVer, minorVer] = (liff.getLineVersion() || \"\").split(\".\");\n                            if (parseInt(majorVer) == 10 && parseInt(minorVer) < 11) {\n                                alert(\"æ¬²ä½¿ç”¨é›»å­åç‰‡ï¼Œè«‹å°‡Lineæ›´æ–°è‡³æœ€æ–°ç‰ˆæœ¬\");\n                            } else {\n                                console.log(\"TargetPicker end\");\n                            }\n                            }\n                        })\n                        .catch(function (error) {\n                            alert(\"å‚³é€å¤±æ•—ï¼Œè«‹å°‡Lineæ›´æ–°è‡³æœ€æ–°ç‰ˆæœ¬\");\n                            console.log(error);\n                        });\n                    }\n                }                \n        </script>\n\n        <style>\n        .button {\n            background-color: #008CBA;\n            color: white;\n            border: 2px solid #008CBA;\n            border-radius: 5px;\n            padding: 16px 32px;\n            text-align: center;\n            text-decoration: none;\n            display: inline-block;\n            font-size: 16px;\n            margin: 4px 2px;\n            transition-duration: 0.4s;\n            cursor: pointer;\n            width: 100%;\n        }\n        .center {\n            display: block;\n            margin-left: auto;\n            margin-right: auto;\n            width: 60%;\n        }\n        </style>\n    </body>\n</html>","output":"str","x":542.0000038146973,"y":179.00000095367432,"wires":[["e184963c.01a588"]]},{"id":"ccb5bcbe.5d6bf","type":"change","z":"b59bc4d3.917488","name":"è¨­å®š liff_id","rules":[{"t":"set","p":"title","pt":"msg","to":"Node-red æ¸¬è©¦","tot":"str"},{"t":"set","p":"liff_id","pt":"msg","to":"1655113925-ZYDom4rm","tot":"str"},{"t":"set","p":"short_name","pt":"msg","to":"å±±é›²ç§‘æŠ€åç‰‡","tot":"str"},{"t":"set","p":"my_card","pt":"msg","to":"{   \"type\": \"carousel\",   \"contents\": [     {       \"type\": \"bubble\",       \"hero\": {         \"type\": \"image\",         \"size\": \"full\",         \"aspectRatio\": \"20:13\",         \"aspectMode\": \"cover\",         \"url\": \"https://imgur.com/rn2QJgJ.jpg\"       },       \"body\": {         \"type\": \"box\",         \"layout\": \"vertical\",         \"spacing\": \"sm\",         \"contents\": [           {             \"type\": \"text\",             \"text\": \"Jason\",             \"wrap\": true,             \"weight\": \"bold\",             \"size\": \"xl\"           },           {             \"type\": \"box\",             \"layout\": \"baseline\",             \"contents\": [               {                 \"type\": \"text\",                 \"text\": \"å±±é›²å‰µæ–°ç§‘æŠ€-ç‰©è¯ç¶²è¬›å¸«\",                 \"wrap\": true,                 \"weight\": \"bold\",                 \"size\": \"sm\",                 \"flex\": 0               }             ]           },           {             \"type\": \"box\",             \"layout\": \"baseline\",             \"contents\": []           }         ]       },       \"footer\": {         \"type\": \"box\",         \"layout\": \"vertical\",         \"spacing\": \"sm\",         \"contents\": [           {             \"type\": \"button\",             \"style\": \"primary\",             \"action\": {               \"type\": \"uri\",               \"label\": \"èˆ‡æˆ‘è¯ç¹«\",               \"uri\": \"https://line.me/ti/p/Rjiz_ydf2Z\"             },             \"color\": \"#00ACC7\"           },           {             \"type\": \"button\",             \"style\": \"primary\",             \"action\": {               \"type\": \"uri\",               \"label\": \"åˆ†äº«æˆ‘çš„åç‰‡\",               \"uri\": \"https://liff.line.me/1655113925-ZYDom4rm\"             },             \"color\": \"#00ACC7\"           },           {             \"type\": \"button\",             \"flex\": 2,             \"style\": \"primary\",             \"color\": \"#00ACC7\",             \"action\": {               \"type\": \"uri\",               \"label\": \"å®˜æ–¹ç¶²ç«™\",               \"uri\": \"https://3anology.com.tw/\"             }           }         ]       }     },     {       \"type\": \"bubble\",       \"hero\": {         \"type\": \"image\",         \"size\": \"full\",         \"aspectRatio\": \"20:13\",         \"aspectMode\": \"cover\",         \"url\": \"https://imgur.com/zCYprab.jpg\"       },       \"body\": {         \"type\": \"box\",         \"layout\": \"vertical\",         \"spacing\": \"sm\",         \"contents\": [           {             \"type\": \"box\",             \"layout\": \"vertical\",             \"contents\": [],             \"position\": \"relative\"           },           {             \"type\": \"text\",             \"text\": \" \"           },           {             \"type\": \"text\",             \"text\": \"å°ˆæ¥­æŠ€èƒ½ğŸŒ»\",             \"wrap\": true,             \"weight\": \"bold\",             \"size\": \"xl\"           },           {             \"type\": \"box\",             \"layout\": \"baseline\",             \"contents\": [               {                 \"type\": \"text\",                 \"text\": \"C/C++ï¼ŒNode-Red(IOT)\",                 \"wrap\": true,                 \"size\": \"sm\",                 \"flex\": 0,                 \"weight\": \"bold\"               }             ]           },           {             \"type\": \"box\",             \"layout\": \"baseline\",             \"contents\": [               {                 \"type\": \"text\",                 \"text\": \"ROS(æ©Ÿå™¨äººé–‹æºå¹³å°)\",                 \"wrap\": true,                 \"size\": \"sm\",                 \"flex\": 0,                 \"weight\": \"bold\"               }             ]           },           {             \"type\": \"box\",             \"layout\": \"baseline\",             \"contents\": []           },           {             \"type\": \"box\",             \"layout\": \"vertical\",             \"contents\": []           },           {             \"type\": \"text\",             \"text\": \"æˆèª²ç¶“æ­·ğŸŒ»\",             \"wrap\": true,             \"weight\": \"bold\",             \"size\": \"xl\"           },           {             \"type\": \"box\",             \"layout\": \"baseline\",             \"contents\": [               {                 \"type\": \"text\",                 \"text\": \"ã€å·¥ç ”é™¢ã€‘æ‰“é€ Line-bot èŠå¤©æ©Ÿå™¨äºº\",                 \"wrap\": true,                 \"weight\": \"bold\",                 \"size\": \"sm\",                 \"flex\": 0               }             ]           },           {             \"type\": \"box\",             \"layout\": \"baseline\",             \"contents\": [               {                 \"type\": \"text\",                 \"text\": \"ã€è³‡ç­–æœƒã€‘Node-red in raspberry pi\",                 \"wrap\": true,                 \"weight\": \"bold\",                 \"size\": \"sm\",                 \"flex\": 0               }             ]           }         ]       }     }   ] }","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":330,"y":180,"wires":[["80b9e0e4.c75be"]]},{"id":"9cdeb0d4.fe5c2","type":"inject","z":"6a71d497.0c584c","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"600","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":230,"y":180,"wires":[["123e59a7.2eb366"]]},{"id":"123e59a7.2eb366","type":"http request","z":"6a71d497.0c584c","name":"","method":"GET","ret":"txt","paytoqs":"ignore","url":"https://liff--demo.herokuapp.com/","tls":"","persist":false,"proxy":"","authType":"","x":410,"y":180,"wires":[[]]},{"id":"9d0e241f.598538","type":"function","z":"b59bc4d3.917488","name":"è®Šæ•¸åˆå§‹åŒ–","func":"context.global.share_times=[];\n\nfor(var i=0;i<24;i++){\n    context.global.share_times[i] = 0;  \n}","outputs":1,"noerr":0,"initialize":"","finalize":"","x":310,"y":100,"wires":[[]]},{"id":"2fa3b811.0b8638","type":"inject","z":"b59bc4d3.917488","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":"0.1","topic":"","payload":"","payloadType":"date","x":120,"y":100,"wires":[["9d0e241f.598538"]]},{"id":"2ab1d1a9.9da91e","type":"function","z":"b59bc4d3.917488","name":"","func":"var d = new Date();\nvar hour = d.getUTCHours(); \nhour = hour + 8;\nvar n = (hour>=24)?(hour-24):hour;\nvar m = {};\nvar total_times = 0;\nvar times_output = {payload: msg.payload.length};\nm.labels=[];\nm.data=[];\n\ncontext.global.share_times[n]++;\n\nfor(var i=0;i<24;i++){\n    m.labels.push(String(i));\n    m.data.push(context.global.share_times[i]);\n    m.series = [\"æ¬¡æ•¸\"];\n    total_times = total_times + context.global.share_times[i];\n}\nm.data = [m.data];\ntimes_output.payload = total_times;\n\nreturn [{payload:[m],topic:msg.topic},times_output];\n\n\n\n\n","outputs":2,"noerr":0,"initialize":"","finalize":"","x":270,"y":340,"wires":[["4a0c92b8.8c126c"],["b985705c.ffa11"]]},{"id":"8232ab79.e51aa8","type":"ui_button","z":"b59bc4d3.917488","name":"","group":"e94029d3.110278","order":4,"width":4,"height":1,"passthru":false,"label":"Reset","tooltip":"","color":"","bgcolor":"","icon":"","payload":"[ ]","payloadType":"json","topic":"","x":230,"y":260,"wires":[["4a0c92b8.8c126c"]]},{"id":"b985705c.ffa11","type":"ui_text","z":"b59bc4d3.917488","group":"e94029d3.110278","order":1,"width":0,"height":0,"name":"","label":"åç‰‡åˆ†äº«ç¸½æ¬¡æ•¸","format":"{{msg.payload}}","layout":"row-spread","x":500,"y":340,"wires":[]},{"id":"edf32029.65634","type":"debug","z":"b59bc4d3.917488","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":410,"y":480,"wires":[]},{"id":"8c2d32ed.3fca8","type":"inject","z":"b59bc4d3.917488","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"share_times","payloadType":"global","x":180,"y":480,"wires":[["edf32029.65634"]]},{"id":"8c6d5236.b1dd9","type":"inject","z":"b59bc4d3.917488","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":"0.1","topic":"","payload":"","payloadType":"date","x":120,"y":340,"wires":[["2ab1d1a9.9da91e"]]},{"id":"4a0c92b8.8c126c","type":"ui_chart","z":"b59bc4d3.917488","name":"","group":"e94029d3.110278","order":2,"width":0,"height":0,"label":"åç‰‡åˆ†äº«åœ–è¡¨","chartType":"bar","legend":"false","xformat":"HH:mm:ss","interpolate":"linear","nodata":"","dot":false,"ymin":"0","ymax":"","removeOlder":1,"removeOlderPoints":"","removeOlderUnit":"3600","cutout":0,"useOneColor":false,"useUTC":false,"colors":["#0080ff","#ff8000","#c0c0c0","#00ae00","#d20000","#8000ff","#ff9896","#9467bd","#c5b0d5"],"outputs":1,"useDifferentColor":false,"x":460,"y":260,"wires":[[]]}]