[{"id":"49459178.c9087","type":"tab","label":"heroku server","disabled":false,"info":""},{"id":"c598f65d.def838","type":"tab","label":"流程1","disabled":false,"info":""},{"id":"52e2f655.2c0f78","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#0094CE","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif","edited":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#0094CE","edited":false},"page-titlebar-backgroundColor":{"value":"#0094CE","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#ffffff","edited":false},"group-textColor":{"value":"#1bbfff","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#0094ce","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"false","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"400cefcc.505cd","type":"ui_group","name":"Group 1","tab":"950aa41c.07bb38","order":1,"disp":true,"width":"6","collapse":false},{"id":"950aa41c.07bb38","type":"ui_tab","name":"prova","icon":"dashboard","order":20},{"id":"9bd5fb7f.13cf18","type":"template","z":"49459178.c9087","name":"Line 電子名片","field":"payload","fieldType":"msg","format":"html","syntax":"mustache","template":"<!DOCTYPE html>\n<html lang=\"ja\">\n    <head>\n        <meta charset=\"utf-8\">\n        <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n        <meta name=\"viewport\" content=\"width=device-width,initial-scale=1,viewport-fit=cover\">\n        <title>LINE LIFF Demo</title>\n    <body>\n    <meta property=\"og:description\" content=\"山雲科技(電子名片服務)\">\n    <div id=\"app\"></div>\n    <!-- built files will be auto injected -->\n    </body>\n    </head>\n    <body>\n        <div id=\"app\">\n            <img :src=pictureUrl alt=\"profile\" width=\"100px\"　align=\"left\"/>\n            <h2><% displayName %></h2>\n            <p><% userId %></p>\n            <p><% statusMessage %></p>\n            <button id=\"Btn1\" class=\"button\" @click= \"sendTargetPicker\" >分享我的名片</button>\n            <button @click=logout>登出</button>\n        </div>\n\n        <script src=\"https://cdn.jsdelivr.net/npm/vue/dist/vue.js\"></script>\n        <script src=\"https://static.line-scdn.net/liff/edge/2.6.0/sdk.js\"></script>\n        <script>\n            'use strict';\n\n            const app = new Vue({\n                el: '#app',\n                data: function(){\n                    return{\n                        displayName: '',\n                        userId: '',\n                        statusMessage: '',\n                        pictureUrl: '',\n                    }\n                },\n                delimiters: [\"<%\",\"%>\"],\n                methods: {\n                    //get line user info \n                    getProfile: async function(){\n                        const accessToken = liff.getAccessToken();\n                        const profile = await liff.getProfile();\n                        this.displayName = profile.displayName; \n                        this.userId = profile.userId; //ID\n                        this.pictureUrl = profile.pictureUrl; \n                        this.statusMessage = profile.statusMessage; \n                    },\n                    //log out \n                    logout: async function(){\n                        if (liff.isLoggedIn()){\n                            alert('登出');\n                            liff.logout();\n                            window.location.reload();\n                        }\n                    },\n                },\n                \n                //LIFF init \n                mounted: async function(){\n                    await liff.init({\n                        liffId: context.global.liff_id\n                    });  \n                    //LINE內建瀏覽器\n                    if(liff.isInClient()){                        \n                        this.getProfile(); \n                    }else{\n                    //外部瀏覽器\n                        if(liff.isLoggedIn()){\n                            alert('外部瀏覽器');\n                            this.getProfile();\n                        }else{\n                            liff.login();\n                        }\n                    }\n                }                \n                });\n\n                async function sendTargetPicker() {\n                    if (!liff.isLoggedIn()) {\n                        liff.login({ redirectUri: window.location.href });\n                    }\n                    var flex = {\n                        \"type\": \"flex\",\n                        \"altText\": my_short_name,\n                        \"contents\": my_card,          \n                    };\n                    if (liff.isApiAvailable(\"shareTargetPicker\")) {\n                        liff\n                        .shareTargetPicker([flex])\n                        .then(function (res) {\n                            if (res) {\n                            alert(\"電子名片傳送成功\");\n                            liff.closeWindow();\n                            } else {\n                            const [majorVer, minorVer] = (liff.getLineVersion() || \"\").split(\".\");\n                            if (parseInt(majorVer) == 10 && parseInt(minorVer) < 11) {\n                                alert(\"欲使用電子名片，請將Line更新至最新版本\");\n                            } else {\n                                console.log(\"TargetPicker end\");\n                            }\n                            }\n                        })\n                        .catch(function (error) {\n                            alert(\"傳送失敗，請將Line更新至最新版本\");\n                            console.log(error);\n                        });\n                    }\n                }                \n                \n        </script>\n    </body>\n  \n    .button {\n        background-color: #008CBA;\n        color: white;\n        border: 2px solid #008CBA;\n        border-radius: 5px;\n        padding: 16px 32px;\n        text-align: center;\n        text-decoration: none;\n        display: inline-block;\n        font-size: 16px;\n        margin: 4px 2px;\n        transition-duration: 0.4s;\n        cursor: pointer;\n        width: 100%;\n      }\n </html> \n","output":"str","x":420,"y":200,"wires":[["e4f7ce1f.2d842"]]},{"id":"d9d308e5.2f1bb8","type":"http in","z":"49459178.c9087","name":"","url":"/line","method":"get","upload":false,"swaggerDoc":"","x":220,"y":200,"wires":[["9bd5fb7f.13cf18","1cf3d208.82671e"]]},{"id":"e4f7ce1f.2d842","type":"http response","z":"49459178.c9087","name":"","statusCode":"","headers":{},"x":630,"y":200,"wires":[]},{"id":"74a353e0.03df3c","type":"inject","z":"49459178.c9087","name":"設定 liff_id","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"1655113925-ZYDom4rm","payloadType":"str","x":230,"y":100,"wires":[["78e48edf.58722"]]},{"id":"78e48edf.58722","type":"change","z":"49459178.c9087","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"liff_id","tot":"global"}],"action":"","property":"","from":"","to":"","reg":false,"x":410,"y":100,"wires":[[]]},{"id":"1cf3d208.82671e","type":"debug","z":"49459178.c9087","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":410,"y":280,"wires":[]},{"id":"5f87f892.8e4bc8","type":"ui_template","z":"c598f65d.def838","group":"400cefcc.505cd","name":"prova","order":7,"width":"0","height":"0","format":"<html>\n<form>\n <style>\n * {box-sizing: border-box;}\n\n/* Style the input container */\n.input-container {\n display: flex;\n width: 100%;\n margin-bottom: 15px;\n}\n\n/* Style the form icons */\n.icon {\n padding: 10px;\n background: dodgerblue;\n color: white;\n min-width: 50px;\n text-align: center;\n}\n\n/* Style the input fields */\n.input-field {\n width: 100%;\n padding: 10px;\n outline: none;\n}\n\n.input-field:focus {\n border: 2px solid dodgerblue;\n}\n\n/* Set a style for the submit button */\n.btn {\n background-color: dodgerblue;\n color: white;\n padding: 15px 20px;\n border: none;\n cursor: pointer;\n width: 100%;\n opacity: 0.9;\n}\n\n.btn:hover {\n opacity: 1;\n}\n </style>\n \n <h2>Register Form</h2>\n <div class=\"input-container\">\n <i class=\"fa fa-user icon\"></i>\n <input class=\"input-field\" type=\"text\" placeholder=\"Username\" name=\"usrnm\">\n </div>\n\n <div class=\"input-container\">\n <i class=\"fa fa-envelope icon\"></i>\n <input class=\"input-field\" type=\"text\" placeholder=\"Email\" name=\"email\">\n </div>\n\n <div class=\"input-container\">\n <i class=\"fa fa-key icon\"></i>\n <input class=\"input-field\" type=\"password\" placeholder=\"Password\" name=\"psw\">\n </div>\n\n <button type=\"submit\" class=\"btn\" ng-click=\"send({payload:'psw')\">Register</button>\n <body>\n        <div id=\"app\">\n            <img :src=pictureUrl alt=\"profile\" width=\"100px\"　align=\"left\"/>\n            <h2><% displayName %></h2>\n            <p><% userId %></p>\n            <p><% statusMessage %></p>\n            <button id=\"Btn1\" class=\"button\" @click= \"sendTargetPicker\" >分享我的名片</button>\n            <button @click=logout>登出</button>\n        </div>\n\n        <script src=\"https://cdn.jsdelivr.net/npm/vue/dist/vue.js\"></script>\n        <script src=\"https://static.line-scdn.net/liff/edge/2.6.0/sdk.js\"></script>\n        <script>\n            'use strict';\n\n            const app = new Vue({\n                el: '#app',\n                data: function(){\n                    return{\n                        displayName: '',\n                        userId: '',\n                        statusMessage: '',\n                        pictureUrl: '',\n                    }\n                },\n                delimiters: [\"<%\",\"%>\"],\n                methods: {\n                    //get line user info \n                    getProfile: async function(){\n                        const accessToken = liff.getAccessToken();\n                        const profile = await liff.getProfile();\n                        this.displayName = profile.displayName; \n                        this.userId = profile.userId; //ID\n                        this.pictureUrl = profile.pictureUrl; \n                        this.statusMessage = profile.statusMessage; \n                    },\n                    //log out \n                    logout: async function(){\n                        if (liff.isLoggedIn()){\n                            alert('登出');\n                            liff.logout();\n                            window.location.reload();\n                        }\n                    },\n                },\n                \n                //LIFF init \n                mounted: async function(){\n                    await liff.init({\n                        liffId: context.global.liff_id\n                    });  \n                    //LINE內建瀏覽器\n                    if(liff.isInClient()){                        \n                        this.getProfile(); \n                    }else{\n                    //外部瀏覽器\n                        if(liff.isLoggedIn()){\n                            alert('外部瀏覽器');\n                            this.getProfile();\n                        }else{\n                            liff.login();\n                        }\n                    }\n                }                \n                });\n\n                async function sendTargetPicker() {\n                    if (!liff.isLoggedIn()) {\n                        liff.login({ redirectUri: window.location.href });\n                    }\n                    var flex = {\n                        \"type\": \"flex\",\n                        \"altText\": my_short_name,\n                        \"contents\": my_card,          \n                    };\n                    if (liff.isApiAvailable(\"shareTargetPicker\")) {\n                        liff\n                        .shareTargetPicker([flex])\n                        .then(function (res) {\n                            if (res) {\n                            alert(\"電子名片傳送成功\");\n                            liff.closeWindow();\n                            } else {\n                            const [majorVer, minorVer] = (liff.getLineVersion() || \"\").split(\".\");\n                            if (parseInt(majorVer) == 10 && parseInt(minorVer) < 11) {\n                                alert(\"欲使用電子名片，請將Line更新至最新版本\");\n                            } else {\n                                console.log(\"TargetPicker end\");\n                            }\n                            }\n                        })\n                        .catch(function (error) {\n                            alert(\"傳送失敗，請將Line更新至最新版本\");\n                            console.log(error);\n                        });\n                    }\n                }                \n                \n        </script>\n    </body>\n \n \n \n</form>\n</html>\n","storeOutMessages":true,"fwdInMessages":true,"resendOnRefresh":false,"templateScope":"local","x":270,"y":240,"wires":[[]]}]